<div class="item-wall__item-container item-wall__my-listing-card"
    ui-sref="editListing({ id: vm.listing.id })">
<div class="item-wall__item flex-container item-wall__item--highlight">
        <div class="item-wall__image-container">
        <div class="ar-content">
            <div class="my-listing-card__pause-overlay"
                title="Annonce en pause jusqu'au {{ vm.pausedUntil }}: cliquez ici pour réactiver."
                ng-if="vm.listingPaused && vm.listing.quantity"
                ng-click="vm.togglePauseListing($event)">
                <svg class="icon">
                    <use xlink:href="/assets/build/icons/sprite.svg#play"/>
                </svg>
                En pause
                <span ng-show="vm.daysPaused">
                    (J-{{ vm.daysPaused }})
                </span>
            </div>
            <div class="my-listing-card__pause-overlay"
                title="Objet vendu, bravo!"
                ng-if="!vm.listing.quantity">
                <svg class="icon">
                    <use xlink:href="/assets/build/icons/sprite.svg#check-mark"/>
                </svg>
                Vendu
            </div>
            <div class="my-listing-card__pause-overlay"
                title="Annonce désactivée par Sharinplace"
                ng-if="! vm.listingPaused && vm.listing.quantity && vm.listingLocked">
                <svg class="icon">
                    <use xlink:href="/assets/build/icons/sprite.svg#x"/>
                </svg>
                Désactivé
            </div>
            <img class="img--cover-vertical item-wall__image" ng-src="{{::vm.listing.url + '?size=450x300'}}"  alt="{{::vm.imageAlt}}">
        </div>
    </div>
    <div class="item-wall__description flex-item--grow-auto"
        ng-class="{ 'my-listing-card--paused': vm.listingPaused || !vm.listing.quantity }">
        <h3 class="no-margin item-name ellipsis"
            itemprop="name">
            {{::vm.listing.name}}
        </h3>
        <div class="item-wall__price my-listing-card__price">
            <span class="item-wall__selling-icon-container"
                ng-show="vm.listing.listingTypesProperties.TIME.NONE && ! vm.listing.listingTypesProperties.TIME.TIME_FLEXIBLE"
                data-tooltip-placement="auto left"
                data-tooltip-trigger="mouseenter"
                uib-tooltip="{{::vm.sellableTooltip}}"
                data-tooltip-append-to-body="true">
                <svg class="icon">
                    <use xlink:href="{{::vm.sellableIconUrl}}"/>
                </svg>
            </span>
            <span ng-switch="vm.listing.listingTypesProperties.TIME.TIME_FLEXIBLE">
                <span ng-switch-when="true">
                    <span class="item-wall__booking-modes"
                        ng-if="vm.bookingDescription">
                        <span class="text--semibold item-wall__selling-price"
                            ng-show="vm.listing.listingTypesProperties.TIME.NONE">
                            <span class="item-wall__selling-icon-container"
                                ng-show="vm.listing.listingTypesProperties.TIME.NONE"
                                data-tooltip-placement="auto left"
                                data-tooltip-trigger="mouseenter"
                                uib-tooltip="{{::vm.sellableTooltip}}"
                                data-tooltip-append-to-body="true">
                                <svg class="icon">
                                    <use xlink:href="{{::vm.sellableIconUrl}}"/>
                                </svg>
                            </span>
                            {{ ::vm.bookingDescription }}
                        </span>
                        <span class="text--fade">
                            ou
                        </span>
                    </span>
                    <span itemprop="price">{{::vm.listing.dayOnePrice}}</span><span itemprop="priceCurrency" content="EUR">€</span>&nbsp;/&nbsp;j
                </span>
                <span ng-switch-default>
                    <span ng-hide="vm.listing.sellingPrice === 0">
                        <span itemprop="price">{{::vm.listing.sellingPrice}}</span><span itemprop="priceCurrency" content="EUR">€</span>
                    </span>
                    <span ng-show="vm.listing.sellingPrice === 0">
                        {{ ::vm.bookingDescription }}
                    </span>
                </span>
            </span>
        </div>
        <div class="my-listing-card__stats-container">
            <div class="item-wall__rating small"
                ng-if="::vm.listing.nbRatings"
                data-user-score="{{::vm.listing.ownerRating.ratingScore}}"
                data-user-ratings="{{::vm.listing.ownerRating.nbRatings}}"
                data-listing-score="{{::vm.listing.ratingScore}}"
                data-listing-ratings="{{::vm.listing.nbRatings}}"
                data-is-my-listing="true"
                data-append-to-body="true"
                data-sip-rating-stars>
            </div>
            <div class="ellipsis my-listing-card__stats"
                ng-class="{ 'content--invisible': ! vm.showStats }">
                <span ng-click="$event.stopPropagation()"
                    ui-sref="listing({ slug: vm.listing.nameURLSafe + '-' + vm.listing.id })"
                    data-tooltip-placement="auto top"
                    data-tooltip-trigger="mouseenter"
                    uib-tooltip="{{'Cette annonce a été consultée ' + vm.nbViews + ' fois.'}}"
                    data-tooltip-append-to-body="true">
                    <svg class="icon icon--inline">
                        <use xlink:href="/assets/build/icons/sprite.svg#eye-open"/>
                    </svg>
                    {{::vm.listing.nbViews}}
                </span>
                <span
                    data-tooltip-placement="auto top"
                    data-tooltip-trigger="mouseenter"
                    uib-tooltip="{{'Vous avez été contacté(e) ' + vm.nbContacts + ' fois pour cette annonce.'}}"
                    data-tooltip-append-to-body="true">
                    <svg class="icon icon--inline">
                        <use xlink:href="/assets/build/icons/sprite.svg#chat-bubble-two"/>
                    </svg>
                    {{vm.nbContacts}}
                </span>
            </div>
        </div>
        <p class="ellipsis my-listing-card__control"
            ng-class="{ 'control-pending': vm.controlPending }">
            <!-- relative positionning makes IE11 buggy -->
            <span>
                <span class="text-control"
                    title="Supprimez définitivement votre annonce."
                    tabindex="0"
                    data-sip-action-key
                    data-sip-autoblur
                    ng-click="vm.deleteListing($event)">
                    <svg class="icon icon--inline">
                        <use xlink:href="/assets/build/icons/sprite.svg#trash"/>
                    </svg>
                </span>
                <span class="text-control__label">
                    Supprimer
                </span>
            </span>
            <span ng-hide="!vm.listing.quantity">
                <span class="text-control"
                    title="Suspendez votre annonce en cas d'indisponibilité."
                    tabindex="0"
                    data-sip-action-key
                    data-sip-autoblur
                    ng-click="vm.togglePauseListing($event)">
                    <svg class="icon icon--inline">
                        <use xlink:href="{{ vm.pauseIcon }}"/>
                    </svg>
                </span>
                <span class="text-control__label">
                    {{ vm.pauseStr }}
                </span>
            </span>
            <span class="text-control__label text-control__spinner"
                ng-if="vm.controlSpinnerId">
                <span class="spinner-container">
                    <span data-us-spinner="{scale: 0.5}" data-spinner-theme="fiveColors"
                    data-spinner-key="{{vm.controlSpinnerId}}"></span>
                </span>
            </span>
        </p>
    </div>
</div>
</div>
